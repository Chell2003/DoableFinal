@model DoableFinal.Models.ApplicationUser

@{
    ViewData["Title"] = "User Details";
}

<div class="container-fluid px-4">
    <h1 class="mt-4">User Details</h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item"><a asp-controller="Admin" asp-action="Index">Dashboard</a></li>
        <li class="breadcrumb-item"><a asp-controller="Admin" asp-action="Users">Users</a></li>
        <li class="breadcrumb-item active">User Details</li>
    </ol>

    <div class="row">
        <div class="col-xl-12">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-user me-1"></i>
                    User Information
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <h5 class="border-bottom pb-2">Basic Information</h5>
                            <dl class="row">
                                <dt class="col-sm-4">Full Name</dt>
                                <dd class="col-sm-8">@Model.FirstName @Model.LastName</dd>

                                <dt class="col-sm-4">Email</dt>
                                <dd class="col-sm-8">@Model.Email</dd>

                                <dt class="col-sm-4">Role</dt>
                                <dd class="col-sm-8">
                                    <span class="badge bg-@(Model.Role switch {
                                        "Admin" => "danger",
                                        "Project Manager" => "success",
                                        "Employee" => "primary",
                                        "Client" => "info",
                                        _ => "secondary"
                                    })">@Model.Role</span>
                                </dd>

                                <dt class="col-sm-4">Status</dt>
                                <dd class="col-sm-8">
                                    <span class="badge bg-@(Model.IsActive ? "success" : "danger")">
                                        @(Model.IsActive ? "Active" : "Inactive")
                                    </span>
                                </dd>

                                <dt class="col-sm-4">Created At</dt>
                                <dd class="col-sm-8">@Model.CreatedAt.ToString("MMM dd, yyyy")</dd>

                                <dt class="col-sm-4">Last Login</dt>
                                <dd class="col-sm-8">
                                    @(Model.LastLoginAt.HasValue ? Model.LastLoginAt.Value.ToString("MMM dd, yyyy HH:mm") : "Never")
                                </dd>
                            </dl>
                        </div>
                        
                        <div class="col-md-6">
                            <h5 class="border-bottom pb-2">Additional Information</h5>
                            <dl class="row">
                                @if (Model.Role == "Employee" || Model.Role == "Project Manager")
                                {
                                    <dt class="col-sm-4">Position</dt>
                                    <dd class="col-sm-8">@Model.Position</dd>

                                    <dt class="col-sm-4">Mobile Number</dt>
                                    <dd class="col-sm-8">@Model.MobileNumber</dd>

                                    <dt class="col-sm-4">Address</dt>
                                    <dd class="col-sm-8">@Model.ResidentialAddress</dd>

                                    <dt class="col-sm-4">Birthday</dt>
                                    <dd class="col-sm-8">@(Model.Birthday?.ToString("MMM dd, yyyy"))</dd>

                                    <dt class="col-sm-4">TIN Number</dt>
                                    <dd class="col-sm-8">@Model.TinNumber</dd>

                                    <dt class="col-sm-4">Pag-IBIG Account</dt>
                                    <dd class="col-sm-8">@Model.PagIbigAccount</dd>
                                }
                                else if (Model.Role == "Client")
                                {
                                    <dt class="col-sm-4">Company Name</dt>
                                    <dd class="col-sm-8">@Model.CompanyName</dd>

                                    <dt class="col-sm-4">Company Address</dt>
                                    <dd class="col-sm-8">@Model.CompanyAddress</dd>

                                    <dt class="col-sm-4">Company Type</dt>
                                    <dd class="col-sm-8">@Model.CompanyType</dd>

                                    <dt class="col-sm-4">Designation</dt>
                                    <dd class="col-sm-8">@Model.Designation</dd>

                                    <dt class="col-sm-4">Mobile Number</dt>
                                    <dd class="col-sm-8">@Model.MobileNumber</dd>

                                    <dt class="col-sm-4">TIN Number</dt>
                                    <dd class="col-sm-8">@Model.TinNumber</dd>
                                }
                            </dl>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between">
                        <a asp-action="Users" class="btn btn-secondary">
                            <i class="bi bi-arrow-left"></i> Back to List
                        </a>
                        <div class="btn-group">
                            <a asp-action="EditUser" asp-route-id="@Model.Id" class="btn btn-primary">
                                <i class="bi bi-pencil"></i> Edit
                            </a>
                            @if (Model.Role != "Admin")
                            {
                                <form asp-action="ArchiveUser" asp-route-userId="@Model.Id" method="post" style="display: inline;">
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="btn btn-warning ms-2"
                                            onclick="return confirm('Are you sure you want to archive this user?')">
                                        <i class="bi bi-archive"></i> Archive
                                    </button>
                                </form>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>